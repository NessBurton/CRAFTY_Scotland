source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
# dirWorking<- "~/eclipse-workspace/CRAFTY_Scotland"
dirWorking<- "~/Nextcloud/CRAFTY/CRAFTY_Scotland"
dirCRAFTYInput <- path.expand(paste0(dirWorking, "/data_Scotland/"))
dirCRAFTYOutput <- path.expand(paste0(dirWorking, "/output"))
dirFigs <- path.expand(paste0(dirWorking, "/figures"))
setwd(dirWorking)
source("RScripts/Functions_CRAFTY_rJava.R")
getwd()
source("Rscripts/Functions_CRAFTY_rJava.R")
source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
jdk.bin.path
getJdkPath()
.jcall( 'java/lang/System', 'S', 'getProperty', 'java.home' )
library(tidyverse)
library(sf)
library(viridis)
library(ggplot2)
library(rJava)
library(jdx)
library(xml2)
library(foreach)
library(tictoc)
### directories/ file paths ----------------------------------------------------
# dirWorking<- "~/eclipse-workspace/CRAFTY_Scotland"
dirWorking<- "~/Nextcloud/CRAFTY/CRAFTY_Scotland"
dirCRAFTYInput <- path.expand(paste0(dirWorking, "/data_Scotland/"))
dirCRAFTYOutput <- path.expand(paste0(dirWorking, "/output"))
dirFigs <- path.expand(paste0(dirWorking, "/figures"))
setwd(dirWorking)
source("Rscripts/Functions_CRAFTY_rJava.R")
### CRAFTY set-up --------------------------------------------------------------
# agent names
aft_names_fromzero <- c("agroforestry",
"consvnative",
"estateconsv",
"estatemulti",
"estatesport",
"extarable",
"extpastoral",
"intarable",
"intpastoral",
"marginal",
"multimixed",
"multinb",
"multinc",
"multinnb",
"multinnc",
"prodnbroad",
"prodnconifer",
"prodnnbroad",
"prodnnconifer",
"waterurban")
# location of the CRAFTY Jar file
path_crafty_jar <- path.expand(paste0(dirWorking, "/lib/CRAFTY_KIT_engine_2021.jar"))
# location of the CRAFTY lib files
path_crafty_libs <- path.expand(paste0(dirWorking, "/lib/"))
crafty_libs <- list.files(paste0(path_crafty_libs), pattern = "jar")
# make sure that in the classpath setting , gt-opengis-9.0.jar must be included before geoapi-20050403.jar. Otherwise it throws an uncatchable error during the giving up process: loading libraries without ordering them particularly, the opengis library is loaded after the geoapi library following alphabetical order.
# related commit - https://github.com/CRAFTY-ABM/CRAFTY_CoBRA/commit/4ce1041cae349572032fc7e25be49652781f5866
crafty_libs <- crafty_libs[crafty_libs != "geoapi-20050403.jar"  ]
crafty_libs <- c(crafty_libs,  "geoapi-20050403.jar")
# java configuration
crafty_jclasspath <- c(path_crafty_jar, paste0(path_crafty_libs, crafty_libs))
# Random seed used in CRAFTY
random_seed_crafty <- 99
# CRAFTY timesteps
start_year_idx <- 2020
end_year_idx <- 2100
parallelize <- FALSE
parallelize <- FALSE
# if getting random Java errors, restart Rstudio
# initialise Java only once
if (!rJava::.jniInitialized) {
.jinit(parameters="-Dlog4j.configuration=log4j2020_normal.properties")
.jinit(parameters = "-Dfile.encoding=UTF-8", silent = FALSE, force.init = FALSE)
.jinit( parameters=paste0("-Xms", java.ms, " -Xmx", java.mx)) # The .jinit returns 0 if the JVM got initialized and a negative integer if it did not. A positive integer is returned if the JVM got initialized partially. Before initializing the JVM, the rJava library must be loaded.
}
# add java classpath
.jclassPath() # print out the current class path settings.
for (i in 1:length(crafty_jclasspath)) {
.jaddClassPath(crafty_jclasspath[i])
}
source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
jdk.base.path
library(tidyverse)
library(sf)
library(viridis)
library(ggplot2)
library(rJava)
library(jdx)
library(xml2)
library(foreach)
library(tictoc)
### directories/ file paths ----------------------------------------------------
# dirWorking<- "~/eclipse-workspace/CRAFTY_Scotland"
dirWorking<- "~/Nextcloud/CRAFTY/CRAFTY_Scotland"
dirCRAFTYInput <- path.expand(paste0(dirWorking, "/data_Scotland/"))
dirCRAFTYOutput <- path.expand(paste0(dirWorking, "/output"))
dirFigs <- path.expand(paste0(dirWorking, "/figures"))
setwd(dirWorking)
source("Rscripts/Functions_CRAFTY_rJava.R")
### CRAFTY set-up --------------------------------------------------------------
# agent names
aft_names_fromzero <- c("agroforestry",
"consvnative",
"estateconsv",
"estatemulti",
"estatesport",
"extarable",
"extpastoral",
"intarable",
"intpastoral",
"marginal",
"multimixed",
"multinb",
"multinc",
"multinnb",
"multinnc",
"prodnbroad",
"prodnconifer",
"prodnnbroad",
"prodnnconifer",
"waterurban")
# location of the CRAFTY Jar file
path_crafty_jar <- path.expand(paste0(dirWorking, "/lib/CRAFTY_KIT_engine_2021.jar"))
# location of the CRAFTY lib files
path_crafty_libs <- path.expand(paste0(dirWorking, "/lib/"))
crafty_libs <- list.files(paste0(path_crafty_libs), pattern = "jar")
# make sure that in the classpath setting , gt-opengis-9.0.jar must be included before geoapi-20050403.jar. Otherwise it throws an uncatchable error during the giving up process: loading libraries without ordering them particularly, the opengis library is loaded after the geoapi library following alphabetical order.
# related commit - https://github.com/CRAFTY-ABM/CRAFTY_CoBRA/commit/4ce1041cae349572032fc7e25be49652781f5866
crafty_libs <- crafty_libs[crafty_libs != "geoapi-20050403.jar"  ]
crafty_libs <- c(crafty_libs,  "geoapi-20050403.jar")
# java configuration
crafty_jclasspath <- c(path_crafty_jar, paste0(path_crafty_libs, crafty_libs))
# Random seed used in CRAFTY
random_seed_crafty <- 99
# CRAFTY timesteps
start_year_idx <- 2020
end_year_idx <- 2100
parallelize <- FALSE
rJava::.jniInitialized
help(.jinit)
rJava::.jniInitialized
library(rJava)
rJava::.jniInitialized
library(tidyverse)
library(sf)
library(viridis)
library(ggplot2)
library(rJava)
library(jdx)
library(xml2)
library(foreach)
library(tictoc)
### directories/ file paths ----------------------------------------------------
# dirWorking<- "~/eclipse-workspace/CRAFTY_Scotland"
dirWorking<- "~/Nextcloud/CRAFTY/CRAFTY_Scotland"
dirCRAFTYInput <- path.expand(paste0(dirWorking, "/data_Scotland/"))
dirCRAFTYOutput <- path.expand(paste0(dirWorking, "/output"))
dirFigs <- path.expand(paste0(dirWorking, "/figures"))
setwd(dirWorking)
library(parallel)
#library(doMC)
library(raster)
library(sp)
# Get java home using rJava
getJdkPath = function(x) {
require(rJava)
.jinit()
jdk.base.path <- .jcall( 'java/lang/System', 'S', 'getProperty', 'java.home' )
# if it does not work,
# jdk.base.path <- "/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/" # OSX
# jdk.base.path <- "/usr/lib/jvm/java-8-openjdk-amd64/" # Linux
jdk.bin.path <- paste0(jdk.base.path, "bin/java")
return(jdk.bin.path)
}
java.mx <- "12g" # 25 GB max in LRZ
java.ms <- "1g -d64"
rJava::.jniInitialized
getJdkPath = function(x) {
require(rJava)
.jinit()
jdk.base.path <- .jcall( 'java/lang/System', 'S', 'getProperty', 'java.home' )
# if it does not work,
# jdk.base.path <- "/Library/Java/JavaVirtualMachines/jdk1.8.0_171.jdk/Contents/Home/" # OSX
# jdk.base.path <- "/usr/lib/jvm/java-8-openjdk-amd64/" # Linux
jdk.bin.path <- paste0(jdk.base.path, "bin/java")
return(jdk.bin.path)
}
require(rJava)
jdk.base.path <- .jcall( 'java/lang/System', 'S', 'getProperty', 'java.home' )
source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
CRAFTY lib files
path_crafty_libs <- path.expand(paste0(dirWorking, "/lib/"))
crafty_libs <- list.files(paste0(path_crafty_libs), pattern = "jar")
# make sure that in the classpath setting , gt-opengis-9.0.jar must be included before geoapi-20050403.jar. Otherwise it throws an uncatchable error during the giving up process: loading libraries without ordering them particularly, the opengis library is loaded after the geoapi library following alphabetical order.
# related commit - https://github.com/CRAFTY-ABM/CRAFTY_CoBRA/commit/4ce1041cae349572032fc7e25be49652781f5866
crafty_libs <- crafty_libs[crafty_libs != "geoapi-20050403.jar"  ]
crafty_libs <- c(crafty_libs,  "geoapi-20050403.jar")
crafty_libs
# location of the CRAFTY lib files
path_crafty_libs <- path.expand(paste0(dirWorking, "/lib/"))
crafty_libs <- list.files(paste0(path_crafty_libs), pattern = "jar")
# make sure that in the classpath setting , gt-opengis-9.0.jar must be included before geoapi-20050403.jar. Otherwise it throws an uncatchable error during the giving up process: loading libraries without ordering them particularly, the opengis library is loaded after the geoapi library following alphabetical order.
# related commit - https://github.com/CRAFTY-ABM/CRAFTY_CoBRA/commit/4ce1041cae349572032fc7e25be49652781f5866
crafty_libs <- crafty_libs[crafty_libs != "geoapi-20050403.jar"  ]
crafty_libs <- c(crafty_libs,  "geoapi-20050403.jar")
crafty_libs
# related commit - https://github.com/CRAFTY-ABM/CRAFTY_CoBRA/commit/4ce1041cae349572032fc7e25be49652781f5866
crafty_libs <- crafty_libs[crafty_libs != "geoapi-20050403.jar"  ]
crafty_libs <- c(crafty_libs,  "geoapi-20050403.jar")
# java configuration
crafty_jclasspath <- c(path_crafty_jar, paste0(path_crafty_libs, crafty_libs))
# Random seed used in CRAFTY
random_seed_crafty <- 99
# CRAFTY timesteps
start_year_idx <- 2020
end_year_idx <- 2100
parallelize <- FALSE
crafty_libs
path_crafty_jar <- path.expand(paste0(dirWorking, "/lib/CRAFTY_KIT_engine_2021.jar"))
# location of the CRAFTY lib files
path_crafty_libs <- path.expand(paste0(dirWorking, "/lib/"))
crafty_libs <- list.files(paste0(path_crafty_libs), pattern = "jar")
# make sure that in the classpath setting , gt-opengis-9.0.jar must be included before geoapi-20050403.jar. Otherwise it throws an uncatchable error during the giving up process: loading libraries without ordering them particularly, the opengis library is loaded after the geoapi library following alphabetical order.
# related commit - https://github.com/CRAFTY-ABM/CRAFTY_CoBRA/commit/4ce1041cae349572032fc7e25be49652781f5866
crafty_libs <- crafty_libs[crafty_libs != "geoapi-20050403.jar"  ]
crafty_libs <- c(crafty_libs,  "geoapi-20050403.jar")
# java configuration
crafty_jclasspath <- c(path_crafty_jar, paste0(path_crafty_libs, crafty_libs))
# Random seed used in CRAFTY
random_seed_crafty <- 99
# CRAFTY timesteps
start_year_idx <- 2020
end_year_idx <- 2100
parallelize <- FALSE
crafty_libs
source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
source('~/Nextcloud/CRAFTY/CRAFTY_Scotland/Rscripts/Run_CRAFTY_Scotland.R')
